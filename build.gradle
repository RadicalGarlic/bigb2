plugins {
}

repositories {
    jcenter()
}

configurations {
    create('all')
}

dependencies {
    add('all', 'io.ktor:ktor-client:1.5.1')
}

defaultTasks 'compile'

task compile(type: Exec) {
    doFirst {
        def jars = new StringBuilder()
        def sep = ''
        configurations['all'].files.each{ f ->
            jars.append(sep)
            jars.append(f)
            sep = ':'
        }

        commandLine 'kotlinc', '-include-runtime', '-d', 'bin/bbb2.jar',
                    '-cp', jars, 'src/main.kt', 'src/api.kt'
    }
}
