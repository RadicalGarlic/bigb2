plugins {
}

repositories {
    mavenCentral()
}

configurations {
    create('all')
}

dependencies {
    add('all', 'io.ktor:ktor-client:1.5.1')
}

defaultTasks 'compile'

task compile(type: Exec) {
    def jars = new StringBuilder()
    def sep = ''
    configurations['all'].files.each{ f ->
        jars.append(sep)
        jars.append(f)
        sep = ':'
    }

    def a = ['kotlinc', '-include-runtime', '-d', 'bin/bbb2.jar', '-cp', jars, 'src/main.kt']

    
    commandLine a

/*
    doLast {
        configurations['all'].files.each{ file ->
            println "$file"
        }

        def out = new StringBuilder()
        'kotlinc -version'.execute().waitForProcessOutput(out, out)
        println "$out"

        'kotlinc 
    }
*/
}
